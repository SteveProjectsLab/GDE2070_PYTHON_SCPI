#https://pyvisa.readthedocs.io/en/latest/introduction/communication.html

import pyvisa
import time
rm = pyvisa.ResourceManager()
#print(rm.list_resources())
#('ASRL1::INSTR', 'ASRL2::INSTR', 'GPIB0::12::INSTR')
DGE2070 = rm.open_resource('USB0::0x5345::0x1235::23380879::INSTR')
print("DGE2070 connected!\n")
print(DGE2070.query("*IDN?"))
#DGE2070.write('*IDN?')
#print(DGE2070.read())
#DGE2070.write('*RST')
#print('Device Reset')
DGE2070.write('OUTPut1:STATe ON')
print("Channel 1 ON!")

DGE2070.write('SOUR1:FREQ:FIX 1kHz')
print("Channel 1 FREQUENCY=1kHz")
time.sleep(2)
DGE2070.write('SOUR1:FREQ:FIX 5kHz')
print("Channel 1 FREQUENCY=5kHz")
time.sleep(2)
DGE2070.write('SOUR1:FREQ:FIX 10kHz')
print("Channel 1 FREQUENCY=10kHz")
time.sleep(2)
DGE2070.write('SOUR1:FREQ:FIX 15kHz')
print("Channel 1 FREQUENCY=15kHz")
time.sleep(2)
DGE2070.write('SOUR1:FREQ:FIX 20kHz')
print("Channel 1 FREQUENCY=20kHz")
time.sleep(2)
DGE2070.write('OUTPut1:STATe OFF')
print("Channel 1 OFF!")